var Recap;(()=>{"use strict";var e={732:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(361);t.default=class{static isWebContext(){return null===this.vscode}static inWebDarkMode(){return this.isWebContext()&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}initMessages(e){this.messageSpecs=e,window.addEventListener("message",(async e=>this.handleMessage(e)))}handleMessage(e){const t=this.messageSpecs[e.data.type];t&&t.bind(this)(e.data)}static documentChanged(e="content"){this.vscode?.postMessage({type:"change",kind:e})}static exportRecapFiles(){this.vscode?.postMessage({type:"exportFiles"})}static publishToGithubPages(){this.vscode?.postMessage({type:"publishToGithubPages"})}static logWebviewError(e){this.vscode?.postMessage({type:"logError",args:e})}static openOtherRecapFile(e){this.vscode?.postMessage({type:"open",path:e})}static returnFileData(e,t){this.vscode?.postMessage({type:"response",requestId:t,body:Array.from((new TextEncoder).encode(e))})}static showErrorMessage(e){this.vscode?.postMessage({type:"error",text:e})}static showInformationMessage(e){this.vscode?.postMessage({type:"info",text:e})}static showLink(e){this.isWebContext()?this.showLinkAction?.performWith(e):this.vscode?.postMessage({type:"showLink",linkTarget:e})}static showWarningMessage(e){this.vscode?.postMessage({type:"warning",text:e})}static viewHelp(){this.vscode?.postMessage({type:"viewHelp"})}static webviewIsReady(){this.vscode?.postMessage({type:"ready"})}static showMarkdownLink(e){const t=e.indexOf(":"),i=e.substring(2,t),o=s.default.recreateLinkSelections(e.substring(t+1));this.showLinkAction?.performWith(new s.default(i,o))}}},779:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(732),o=i(361);class r extends s.default{constructor(e){super(),this.params=e,this.initMessages({addNote:this.addNote,getFileData:this.getFileData,goDown:this.goDown,goUp:this.goUp,linkNote:this.linkNote,redo:this.redo,revert:this.revert,saved:this.documentWasSaved,setLinkDest:this.setLinkDest,showMarkdownLink:this.showMarkdownLink,toggleEdit:this.toggleEdit,undo:this.undo,viewHidden:this.viewHidden})}static initialize(e){this.instance=new r(e)}addNote(){this.params.editModeProp.get()&&this.params.addNoteAction.perform()}documentWasSaved(){this.params.documentWasSavedAction.perform()}getFileData(e){const t=this.params.documentProp.get();if(!t)return;this.params.prepareToSaveAction.perform();const i=t.getJsonData(),o=JSON.stringify(i,null,this.params.outputFileSpacingProp.get());s.default.returnFileData(o,e.requestId)}goDown(){this.params.goDownAction.perform()}goUp(){this.params.goUpAction.perform()}linkNote(){this.params.createNoteLinkAction.perform()}redo(){this.params.redoAction.perform()}revert(e){this.params.revertAction.performWith(e.body.content)}setLinkDest(e){const{file:t,selections:i,text:s,offset:r}=e.body;this.params.mostRecentSelectionProp.set(new o.default(t,i,s,r))}showMarkdownLink(e){const t=e.body.file.split(":"),i=new o.default(t[0],o.default.recreateLinkSelections(t[1]));this.params.showMarkdownLinkAction.performWith(i)}toggleEdit(){this.params.toggleEditAction.perform()}undo(){this.params.undoAction.perform()}viewChanged(){this.params.viewChangedAction.perform()}viewHidden(){this.params.viewHiddenAction.perform()}}t.default=r},896:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(732);class o extends s.default{constructor(e){super(),this.params=e,this.initMessages({config:this.updateConfig,init:this.initWebView,quickPick:this.quickPick}),s.default.webviewIsReady()}static initialize(e){this.instance=new o(e)}initWebView(e){this.params.initWebViewAction.performWith(e.body)}quickPick(e){this.params.quickPickAction.perform()}updateConfig(e){this.params.updateConfigAction.performWith(e.body)}}t.default=o},361:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkTarget=void 0;const s=i(813),o=i(961);class r{constructor(e,t,i="",s=0){this.text="",this.html="",this.file=!e||e.startsWith("./")?e:"./"+e,this.selections=t||[],this.targetText=i,this.targetOffset=s}asString(){return this.isValid()?this.hasSelections()?this.file+":"+this.selections.flat().join(","):this.file:""}describeOneSelection(e){return e[0]===e[2]?"line "+(e[0]+1):"lines "+(e[0]+1)+" - "+(e[2]+1)}describeSelections(){return 1===this.selections.length?this.describeOneSelection(this.selections[0]):this.describeOneSelection(this.selections[0])+" + more"}description(e="(no link)"){return this.isValid()?this.hasSelections()?this.file+", "+this.describeSelections():this.file:e}hasSelections(){return this.selections&&this.selections.length>0}isValid(){return Boolean(this.file)}matches(e){return this.file===e.file&&this.selections.toString()===e.selections.toString()}static recreateLinkSelections(e){if(!e)return[];const t=e.split(",").map((e=>parseInt(e))),i=[];for(;t.length>0;)i.push(t.splice(0,4));return i}getSelectionInterval(e){if(!this.text)return o.default.nullInterval;const t=this.text.split("\n"),i=s.default.sum(t.slice(0,e[0]),(e=>e.length+1))+e[1],r=s.default.sum(t.slice(0,e[2]),(e=>e.length+1))+e[3];return o.default.create(i,r)}}t.LinkTarget=r,r.emptyLinkTarget=new r("",[],"",0),t.default=r},694:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(813),o=i(851);class r{constructor(e){this.annotations=[],this.changed=!1,this.nextID=1,this.valid=!1,this.title="untitled",this.author="unknown",this.creationDate=new Date,this.description="",this.load(e),this.changed=!1}isEmpty(){return this.isValid()&&0===this.annotations.length}isValid(){return this.valid}setFileName(e){this.fileName=e,this.title||(this.title=e)}load(e){this.valid=!1;try{const t=JSON.parse(e||"{}"),i=t.annotations||[];this.annotations=i.map((e=>new o.default(e))),this.annotations.forEach(((e,t)=>e.id=t)),this.nextID=this.annotations.length,this.valid=!0,this.title=t.title||"",this.author=t.author||"",this.creationDate=t.creationDate||(new Date).toDateString(),this.description=t.description||""}catch{}}getJsonData(){return this.updateResources(),{annotations:this.annotations,title:this.title,author:this.author,creationDate:this.creationDate,description:this.description}}setDocumentChanged(e){this.changed=e}addNoteAtIndex(e,t){return this.annotations=-1===t?[...this.annotations,e]:s.default.splice(this.annotations,t+1,0,e),e}createNewNote(){return o.default.createEmptyNote(this.nextNoteID())}indexOfNote(e){return this.annotations.indexOf(e)}addNoteAfter(e){const t=o.default.createEmptyNote(this.nextNoteID());return this.addNoteAtIndex(t,e?this.annotations.indexOf(e):-1)}deleteNote(e){this.annotations.length>1&&(this.annotations=this.annotations.filter((t=>t!==e)))}moveNoteDown(e){const t=this.annotations.indexOf(e);t>0&&(this.annotations=s.default.moveElementDown(this.annotations,t))}moveNoteUp(e){const t=this.annotations.indexOf(e);t>0&&(this.annotations=s.default.moveElementUp(this.annotations,t))}nextNoteID(){return this.nextID=this.nextID+1,this.nextID}numberOfNotes(){return this.annotations.length}allLinkTargetFileNames(){return[...new Set(this.annotations.reduce(((e,t)=>[...e,...t.allTargetFileNames()]),[]))]}updateResources(){this.annotations.forEach((e=>e.updateResources()))}allResources(){return[...new Set(this.annotations.reduce(((e,t)=>[...e,...t.resources]),[]))]}}r.nullDocument=new r("{}"),t.default=r},851:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0});const o=i(363),r=i(361);class n{constructor(e){this.changed=!1,this.markdownLinkTargets=[],this.resources=[],this.contents=e.contents,this.id=e.id;const t=e.primaryLinkTarget;this.primaryLinkTarget=t?new r.default(t.file,t.selections,t.targetText,t.targetOffset):r.default.emptyLinkTarget,e.markdownLinkTargets?this.markdownLinkTargets=e.markdownLinkTargets.map((e=>new r.default(e.file,e.selections,e.targetText,e.targetOffset))):this.markdownLinkTargets=[],this.resources=e.resources||[]}static createEmptyNote(e){const t={changed:!1,contents:this.defaultContents,id:e,file:"",markdownLinkTargets:[],primaryLinkTarget:r.default.emptyLinkTarget};return new n(t)}setContents(e){this.contents=e,this.resources=Array.from(o.default.extractResources(this.contents))}updateResources(){this.setContents(this.contents)}hasPrimaryLinkTarget(){return this.primaryLinkTarget&&this.primaryLinkTarget.isValid()}setPrimaryLinkTarget(e){this.primaryLinkTarget=e}primaryLinkDescription(){return this.hasPrimaryLinkTarget()?this.primaryLinkTarget.description():"(no link)"}addMarkdownTarget(e){this.markdownLinkTargets.push(e)}allTargetFileNames(){const e=new Set(this.markdownLinkTargets.map((e=>e.file)));return this.hasPrimaryLinkTarget()&&e.add(this.primaryLinkTarget.file),[...new Set(e)]}}s=n,n.defaultContents="## untitled",n.emptyNote=s.createEmptyNote(0),t.default=n},363:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(813),o=i(732);class r{constructor(){this.markdownit=window.markdownit({html:!0,linkify:!0,typographer:!0,highlight:function(e,t){if(t&&hljs.getLanguage(t))try{return hljs.highlight(e,{language:t}).value}catch{}return""}}),r.pluginFileNames.forEach((e=>{const t=e.split(/[-.]+/);if(t.length>=3){const e=t[2],i=window["markdownit"+s.default.capitalizeFirstLetter(e)];i&&(this.markdownit.use(i),console.log("Added plugin "+e))}}))}static convert(e,t,i){return this.converter||(this.converter=new r),this.converter.convertText(e,t,i)}static sanitize(e){return DOMPurify.sanitize(e)}static highlight(e){return this.sanitize(hljs.highlightAuto(e).value)}convertText(e,t,i){if(this.rootPath=i,t){const t=s.default.firstLine(e),i=e.substring(t.length+1);return`<div class="recap-centered-title">\n            ${this.convertOneChunk(t)}\n            </div>\n            ${this.convertOneChunk(i)}`}return this.convertOneChunk(e)}convertOneChunk(e){const t=DOMPurify.sanitize(this.fixAnchorPaths(this.fixImagePaths(this.markdownit.render(e))));return this.fixAnchors(t)}render(e){return this.markdownit.render(e)}fixAnchors(e){if(!e.includes("<a "))return e;const t=document.createElement("div");return t.innerHTML=e,Array.from(t.querySelectorAll("a")).forEach((e=>{const t=e.getAttribute("href");t&&(e.href=this.fixAnchorHref(t))})),t.innerHTML}fixAnchorHref(e){if(e.startsWith("http"))return e;let t=e,i="";const s=e.indexOf(":");if(-1!==s&&(t=e.substring(0,s),i=e.substring(s)),o.default.isWebContext())return t.toLowerCase().endsWith(".recap")?`index.html?recap=${t}`:`javascript:Recap.showLink("${t}${i}")`;const r=t.split(".");return"command:recap."+("recap"===r[r.length-1]?"openrecap?":"showLink?")+encodeURIComponent(`[{"file":"${t}${i}"}]`)}fixAnchorPath(e){return e.startsWith("http")?e:(e.startsWith("./")?"":"./")+e}fixAnchorPaths(e){if(!e.includes("<a "))return e;const t=document.createElement("div");return t.innerHTML=e,Array.from(t.querySelectorAll("a")).forEach((e=>{const t=e.getAttribute("href");t&&(e.href=this.fixAnchorPath(t))})),t.innerHTML}fixImagePaths(e){if(!e.includes("<img"))return e;const t=document.createElement("div");return t.innerHTML=e,Array.from(t.querySelectorAll("img")).forEach((e=>{const t=this.rootPath?.endsWith("/")?"":"/";e.src=this.rootPath+t+e.getAttribute("src")})),t.innerHTML}static extractResources(e){const t=this.converter.fixImagePaths(this.converter.render(e)),i=document.createElement("div");i.innerHTML=t;const s=new Set;return Array.from(i.querySelectorAll("a")).forEach((e=>{let t=e.getAttribute("href");t&&!t.startsWith("http")&&(t.includes(":")&&(t=t.substring(0,t.indexOf(":"))),t.startsWith("./")&&(t=t.substring(2,t.length)),s.add(t))})),Array.from(i.querySelectorAll("img")).forEach((e=>{let t=e.getAttribute("src");if(t){const e=this.converter.rootPath||"";t.startsWith(e)&&(t=t.substring(e.length+1)),s.add(t)}})),s}}t.default=r},892:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(382);class o extends s.default{constructor(e,t){super(e,t),this.params=t}buttonCSS(){return"recap-edit-button"}render(){this.addButton("addNote","add","Add a new note",this.params.addNoteAction).addButton("deleteNote","remove","Remove selected note",this.params.deleteNoteAction).addBlank(1).addButton("createNoteLink","link-external","Link note to most recent selection",this.params.createNoteLinkAction).addButton("removeNoteLink","discard","Remove link",this.params.removeNoteLinkAction).addBlank(2).addButton("moveDown","chevron-down","Move note down",this.params.moveDownAction).addButton("moveUp","chevron-up","Move note up",this.params.moveUpAction).addText("linkDetail","recap-link-detail",this.params.linkDetailProp).addButton("copyMarkdown","markdown","Copy markdown text",this.params.copyMarkdownAction).addButton("copyHTML","code","Copy generated HTML",this.params.copyHTMLAction).addBlank(3).addButton("createMarkdownLink","link","Create markdown link",this.params.createMarkdownLinkAction),this.addWrapping("group-1","recap-button-group-grow-1","addNote","deleteNote","blank-1","createNoteLink","removeNoteLink","blank-2","moveUp","moveDown","linkDetail").addWrapping("group-2","recap-button-group","copyMarkdown","copyHTML","blank-3","createMarkdownLink")}}o.defaultStyle="recap-edit-toolbar",t.default=o},817:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(813);class r extends s.default{constructor(e,t){super(e,t),this.linkTargetProp=t.linkTargetProp}scrollRangeIntoView(e){let t;for(t=e.startContainer,1==t.nodeType&&(t=t.childNodes[e.startOffset]);t&&1!=t.nodeType;)t=t.previousSibling||t.parentNode;t instanceof Element&&o.default.scrollElementIntoViewIfNeeded(t)}selectTargetRanges(e){const t=window.getSelection();t?.removeAllRanges(),e.selections.forEach((i=>{const s=this.convertIntervalToRange(e.getSelectionInterval(i));s&&(t?.addRange(s),this.scrollRangeIntoView(s))}))}render(){const e=this.linkTargetProp.get();e&&(this.setInnerHTML(e.html),this.selectTargetRanges(e))}}r.defaultStyle="link-target-view",t.default=r},512:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(732),o=i(382);class r extends o.default{constructor(e,t){super(e,t),this.params=t,this.toggleEditStyle=this.createProp((()=>"recap-toolbar-button"+(t.editModeProp.get()?"-editable":""))),this.toggleViewHoverText=this.createProp((()=>`Switch to ${t.presentationProp.get()?"view":"presentation"} mode`))}buttonCSS(){return"recap-toolbar-button"}render(){this.addButton("expandAll","expand-all","Expand all notes",this.params.expandAllAction).addButton("collapseAll","collapse-all","Collapse all notes",this.params.collapseAllAction).addBlank(1).addButton("toggleView","list-flat",this.toggleViewHoverText,this.params.toggleViewAction).addBlank(2).addButton("increaseSize","zoom-in","Increase size",this.params.increaseSizeAction).addButton("decreaseSize","zoom-out","Decrease size",this.params.decreaseSizeAction).addButton("goDown","arrow-down","Go to next note",this.params.goDownAction).addButton("goUp","arrow-up","Go to previous note",this.params.goUpAction).addButton("quickPick","arrow-circle-right","Open other recap file",this.params.quickPickAction),s.default.isWebContext()?this.addBlank(3):this.addButton("viewHelp","question","View Recap help",this.params.viewHelpAction).addButton("export","export","Export web bundle",this.params.exportWebBundleAction).addButton("publish","cloud-upload","Publish to Github pages",this.params.publishToGithubPagesAction).addBlank(3).addButton("toggleEdit","edit","Toggle edit mode",this.params.toggleEditAction,this.toggleEditStyle),this.addWrapping("group-1","recap-button-group","expandAll","collapseAll","blank-1","toggleView","blank-2","increaseSize","decreaseSize").addWrapping("group-2","recap-button-group","goDown","goUp").addWrapping("group-3","recap-button-group","quickPick","viewHelp","export","publish","blank-3","toggleEdit")}}r.defaultStyle="recap-toolbar",t.default=r},22:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(961),r=i(813),n=i(363),a=i(851);class l extends s.default{constructor(e,t){super(e,t),this.currentSelectionInterval=o.default.nullInterval,this.lastChar=null,this.params=t,this.note=t.note,this.editableProp=this.createProp((()=>this.isEditable())),this.style=this.createProp(this.currentStyle),this.setTabIndex(0),this.hasFocus=!1,this.setEventActions({click:this.handleClick,blur:this.handleBlur,focus:this.handleFocus,input:this.handleInput,cut:this.handleCut,paste:this.handlePaste,keydown:this.handleKeyDown}),this.previousContents=this.note.contents,this.params.textSelectionProp.addAction(this.createAction(this.selectionChanged)),this.params.textSelectionProp.fireOnAnySet=!0}inPresentationMode(){return this.params.presentationProp.get()}isEditable(){return this.params.editModeProp.get()&&this.params.selectedProp.get()}isExpanded(){return this.params.expandedProp.get()}convertMarkdown(e){return n.default.convert(e,this.inPresentationMode(),this.params.rootPathProp.get())}currentHTML(){return this.convertMarkdown(this.innerText())}currentStyle(){return this.isEditable()?"recap-text-editable":this.inPresentationMode()?"recap-markdown recap-text-presentation":this.isExpanded()?"recap-markdown recap-text-expanded":"recap-markdown recap-text"}render(){if(!this.note)return;this.setContentEditable(this.isEditable());const e=this.note.contents;if(this.isEditable())this.setInnerText(e);else{const t=this.isExpanded()?e:r.default.firstLine(e);this.setInnerHTML(this.convertMarkdown(t))}}afterRender(){this.isEditable()&&this.note.contents===a.default.defaultContents&&this.setSelectionInterval(o.default.create(3,11))}saveNoteContents(){return this.note.contents=this.innerText(),!0}handleBlur(e){this.hasFocus=!1,this.isEditable()&&this.saveNoteContents()}handleFocus(e){this.hasFocus=!0}ignoreKeyEvent(e){return"Clear"===e.key||"CrSel"===e.key||"EraseEof"===e.key||"ExSel"===e.key||"Insert"===e.key}handleKeyDown(e){this.ignoreKeyEvent(e)?e.preventDefault():(this.lastChar=null,"Backspace"===e.key?(e.preventDefault(),this.processBackspace()):"Delete"===e.key?(e.preventDefault(),this.processDelete()):"Tab"===e.key?(e.preventDefault(),this.processSimpleEntry("Tab","  ")):" "===e.key?(e.preventDefault(),this.processSpace()):"Enter"===e.key?(e.preventDefault(),this.processSimpleEntry("Enter","\n")):this.lastChar=e.key,this.previousContents=this.innerText(),this.updateSelectionInterval())}handleClick(e){this.focus(),this.hasFocus&&this.params.textClickedAction.performWith(e)}handleInput(){this.isEditable()&&this.lastChar&&(1!==this.lastChar.length&&console.log("weird char: '"+this.lastChar+"'"),this.processCharacter(this.lastChar))}updateSelectionInterval(){this.currentSelectionInterval=this.getSelectionInterval()}selectionChanged(){if(this.isEditable()){const e=this.params.textSelectionProp.get().getRangeAt(0);this.currentSelectionInterval=this.convertRangeToInterval(e)}}handleCut(e){e.preventDefault(),this.processCut()}handlePaste(e){e.preventDefault(),e.clipboardData&&this.readyForPaste()&&document.getSelection()&&this.processPaste(e.clipboardData.getData("text/plain"))}readyForPaste(){if(!this.isEditable())return!1;const e=document.getSelection();if(!e)return!1;const t=e.getRangeAt(0).startContainer;return!!t&&(t instanceof Text||t===this.elt||t.parentElement===this.elt)}addNoteTextChange(e,t,i,s){this.params.addChangeAction.performWith({ownerClass:"NoteText",ownerID:this.note.id,type:e,position:t,delete:i,add:s})}ensureActive(){this.params.textClickedAction.perform()}async undoChange(e){this.ensureActive();const t=e.position;t&&e.add&&e.add.length>0&&this.deleteTextInInterval(o.default.create(t,t+e.add.length)),t&&e.delete&&e.delete.length>0&&this.insertText(e.delete,t),this.previousContents=this.innerText(),this.updateSelectionInterval()}redoChange(e){this.ensureActive();const t=e.position;t&&e.add&&e.add.length>0&&(t===this.innerText().length?this.insertText("\n"+e.add,t-1):this.insertText(e.add,t)),t&&e.delete&&e.delete.length>0&&this.deleteTextInInterval(o.default.create(t,t+e.delete.length)),this.previousContents=this.innerText(),this.updateSelectionInterval()}currentTextEditingState(){this.currentSelectionInterval||console.log("currentTextEditingState: no selection");const{start:e,end:t}=this.currentSelectionInterval;return{start:e,end:t,selectedText:this.previousContents.substring(e,t),previousChange:this.params.previousChangeProp.get()}}sameChangeOwner(e){return e&&"NoteText"===e.ownerClass&&e.ownerID===this.note.id}mayCoalesceBackspace(e,t,i){return this.sameChangeOwner(e)&&t===i-1&&e.position===t+1&&"backspace"===e.type}processBackspace(){const{start:e,end:t,selectedText:i,previousChange:s}=this.currentTextEditingState();if(0===e&&t===e)return;const r=e===t?e-1:e,n=e===t?this.previousContents.charAt(e):i;this.deleteTextInInterval(o.default.create(r,t)),this.mayCoalesceBackspace(s,r,t)?(s.position=s.position-1,s.delete=this.previousContents.charAt(r)+s.delete):this.addNoteTextChange("backspace",r,n,""),this.setSelectionInterval(o.default.create(r,r))}mayCoalesceCharacter(e,t,i){return this.sameChangeOwner(e)&&t===i&&e.add&&e.position===t-e.add.length&&("char"===e.type||"space"===e.type&&1===e.add.length)}processCharacter(e){const{start:t,end:i,selectedText:s,previousChange:o}=this.currentTextEditingState();this.mayCoalesceCharacter(o,t,i)?(o.type="char",o.add=o.add+e):this.addNoteTextChange("char",t,s,e)}async processCut(){const{start:e,end:t,selectedText:i}=this.currentTextEditingState();0!==i.length&&(this.deleteTextInInterval(o.default.create(e,t)),await navigator.clipboard.writeText(i),this.addNoteTextChange("cut",e,i,""),this.setSelectionInterval(o.default.create(e,e)))}mayCoalesceDelete(e,t,i){return this.sameChangeOwner(e)&&t===i-1&&e.position===t&&"delete"===e.type}processDelete(){const{start:e,end:t,selectedText:i,previousChange:s}=this.currentTextEditingState();if(e===this.previousContents.length&&t===e)return;const r=e===t?t+1:t,n=e===t?this.previousContents.charAt(e):i;this.deleteTextInInterval(o.default.create(e,r)),this.mayCoalesceDelete(s,e,r)?s.delete=s.delete+this.previousContents.charAt(e):this.addNoteTextChange("delete",e,n,""),this.setSelectionInterval(o.default.create(e,e))}processPaste(e){const{start:t,end:i,selectedText:s}=this.currentTextEditingState();this.deleteTextInInterval(o.default.create(t,i)),this.insertText(e,t),this.addNoteTextChange("paste",t,s,e),this.updateSelectionInterval()}mayCoalesceSpace(e,t,i){return this.sameChangeOwner(e)&&t===i&&e.add&&e.position===t-e.add.length&&"space"===e.type}processSpace(){const{start:e,end:t,selectedText:i,previousChange:s}=this.currentTextEditingState();e<t&&this.deleteTextInInterval(o.default.create(e,t)),this.insertText(" ",e),this.mayCoalesceSpace(s,e,t)?s.add=s.add+" ":this.addNoteTextChange("space",e,i," "),this.setSelectionInterval(o.default.create(e+1,e+1))}processSimpleEntry(e,t){const{start:i,end:s,selectedText:r}=this.currentTextEditingState();i<s&&this.deleteTextInInterval(o.default.create(i,s)),"Enter"===e&&i>=this.innerText().length-1?this.insertText("\n\n",i):this.insertText(t,i),this.addNoteTextChange(e,i,r,t),this.setSelectionInterval(o.default.create(i+1,i+1))}}l.defaultStyle="recap-text",t.default=l},508:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(904),r=i(788),n=i(22),a=i(892),l=i(361),c=i(732);class d extends s.default{constructor(e,t){super(e,t),this.params=t,this.note=t.note,this.selectedProp=this.createProp(!1),this.expandedProp=this.createProp(this.isOnlyNote()),this.expandedProp.addAction(this.createAction(this.expansionChanged)),this.textClickedAction=this.createAction(this.textClicked),this.primaryLinkTargetProp=this.createProp(this.note.primaryLinkTarget),this.linkDetailProp=this.createProp(this.primaryLinkDescription()),this.params.selectedNoteViewProp.addAction(this.createAction(this.selectedNoteViewChanged)),this.setClickAction(this.handleClick),this.setEventActions({focus:this.handleFocus}),this.style=this.createProp(this.currentStyle),this.disclosureParams=this.initializeDisclosureParams(),this.noteTextParams=this.initializeNoteTextParams(),this.editToolbarParams=this.initializeEditToolbarParams()}initializeDisclosureParams(){return{openProp:this.expandedProp,toggleAction:this.createAction(this.toggle),style:this.createProp(this.currentDisclosureStyle)}}initializeEditToolbarParams(){return{addNoteAction:this.params.addNoteAction,copyHTMLAction:this.createAction(this.copyGeneratedHTML),copyMarkdownAction:this.createAction(this.copyMarkdown),deleteNoteAction:this.params.deleteNoteAction,createNoteLinkAction:this.params.createNoteLinkAction,createMarkdownLinkAction:this.params.createMarkdownLinkAction,moveUpAction:this.params.moveUpAction,moveDownAction:this.params.moveDownAction,removeNoteLinkAction:this.createAction(this.removeNoteLink,this.noteIsLinked),linkDetailProp:this.linkDetailProp}}initializeNoteTextParams(){return{note:this.note,expandedProp:this.expandedProp,editModeProp:this.params.editModeProp,presentationProp:this.params.presentationProp,previousChangeProp:this.params.previousChangeProp,rootPathProp:this.params.rootPathProp,selectedProp:this.selectedProp,textSelectionProp:this.params.textSelectionProp,addChangeAction:this.params.addChangeAction,textClickedAction:this.textClickedAction}}textClicked(e){this.select().expand()}expansionChanged(){const e=this.params.expandedNoteViewsProp;this.isExpanded()?o.default.addToSet(e,this):o.default.deleteFromSet(e,this)}toggle(){return this.expandedProp.toggle(!0,!1),this.select(),this}isSelected(){return this.selectedProp.get()}selectedNoteViewChanged(e){this.setSelectedOnly(this===e)}setSelectedOnly(e){this.selectedProp.set(e)}setSelected(e){if(this.selectedProp.get()!==e)return e&&this.params.selectedNoteViewProp.set(this),this.selectedProp.set(e),this.scrollIntoViewIfNeeded(),this}select(){return this.setSelected(!0),c.default.showLink(this.primaryLinkTarget()),this}deselect(){return this.setSelected(!1),this}isExpanded(){return this.expandedProp.get()}setExpanded(e){return this.expandedProp.set(e),this.inPresentationMode()||this.scrollIntoViewIfNeeded(),this}expand(){return this.setExpanded(!0),this}collapse(){return this.setExpanded(!1),this}inPresentationMode(){return this.params.presentationProp.get()}inEditMode(){return this.params.editModeProp.get()}handleClick(e){if(e.target instanceof Element){const t=e.target.tagName.toUpperCase();"A"!==t&&"SUMMARY"!==t&&this.textClicked(e)}}handleFocus(){setTimeout((()=>this.textView().focus()))}borderColor(){return this.noteIsLinked()?"recap-note-linked":"recap-note-unlinked"}borderStyle(){return this.isSelected()&&this.params.selectedNoteChangedProp.get()?"recap-note-changed":!this.inEditMode()&&this.isOnlyNote()?"recap-note-noborder":"recap-note-unchanged"}baseStyle(){return this.inPresentationMode()&&this.isSelected()?"recap-note-presentation-selected":this.inPresentationMode()?"recap-note-presentation":this.isSelected()?"recap-note-selected":"recap-note"}currentStyle(){return[this.baseStyle(),this.borderColor(),this.borderStyle()].join(" ")}isOnlyNote(){return 1===this.params.annotationsProp.get().length}currentDisclosureStyle(){return this.isOnlyNote()?"disclosure-single":this.inEditMode()&&this.isSelected()?"disclosure-editable":this.inPresentationMode()?"disclosure-presentation":"disclosure"}render(){this.addChild({name:"disclosure",viewClass:r.ZDisclosure,params:this.disclosureParams}),this.addChild({name:"text",viewClass:n.default,params:this.noteTextParams}),this.isSelected()&&this.inEditMode()&&!this.inPresentationMode()&&this.addChild({name:"edit-toolbar",viewClass:a.default,params:this.editToolbarParams}),this.addWrapping("container","recap-text-container","disclosure","text")}textView(){return this.children.find((e=>e instanceof n.default))}copyGeneratedHTML(){navigator.clipboard.writeText(this.textView().currentHTML())}copyMarkdown(){navigator.clipboard.writeText(this.note.contents)}createMarkdownLink(){const e=window.getSelection(),t=this.params.mostRecentSelectionProp.get();if(!e||!t.isValid())return;const i=this.textView().getSelectionInterval(),s=e.getRangeAt(0),o=s.extractContents().textContent,r=`[${o}](${t.asString()})`,n=document.createTextNode(r);s.insertNode(n),this.note.addMarkdownTarget(t),this.textView().addNoteTextChange("createMarkdownLink",i.start,o,r)}primaryLinkTarget(){return this.primaryLinkTargetProp.get()}setPrimaryLinkTarget(e){this.primaryLinkTargetProp.set(e),this.note.setPrimaryLinkTarget(e),this.linkDetailProp.set(e.description())}primaryLinkDescription(){return"Link: "+(this.noteIsLinked()?this.primaryLinkTarget().description():"(none)")}noteIsLinked(){return this.primaryLinkTarget().isValid()}createNoteLink(){const e=this.params.mostRecentSelectionProp.get();if(!e.isValid())return void c.default.showWarningMessage("No selection has been made");const t=this.primaryLinkTarget();t&&t.matches(e)||(this.setPrimaryLinkTarget(e),this.addNoteViewChange("createLink",t,e))}removeNoteLink(){const e=this.primaryLinkTarget();if(!e||!e.isValid())return;const t=l.default.emptyLinkTarget;this.setPrimaryLinkTarget(t),this.addNoteViewChange("removeLink",e,t)}prepareToSave(){this.textView().isContentEditable()&&this.saveNoteContents()}saveNoteContents(){this.textView().saveNoteContents()}addNoteViewChange(e,t,i){const s={ownerClass:"NoteView",ownerID:this.note.id,type:e,oldTarget:t,newTarget:i};s.ownerID=this.note.id,this.params.addChangeAction.performWith(s)}ensureActive(){this.select().expand()}undoChange(e){this.ensureActive(),"createLink"!==e.type&&"removeLink"!==e.type||this.setPrimaryLinkTarget(e.oldTarget)}redoChange(e){this.ensureActive(),"createLink"!==e.type&&"removeLink"!==e.type||this.setPrimaryLinkTarget(e.newTarget)}}d.defaultStyle="recap-note",t.default=d},412:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(974),r=i(738),n=i(813),a=i(508),l=i(512),c=i(361),d=i(694),h=i(779),p=i(732),u=i(851),g=i(382);class m extends s.default{constructor(e,t){super(e,t),this.undoStack=[],this.redoStack=[],this.inUndoOrRedo=!1,this.params=t,this.style=this.createProp(this.currentStyle),this.scaleFactor=this.createProp(1),this.presentationProp=this.createProp(!1),this.expandedNoteViewsProp=this.createProp(new Set),this.indexOfSelectedNoteViewProp=this.createProp(-1),this.mostRecentSelectionProp=this.createProp(c.default.emptyLinkTarget),this.selectedNoteViewProp=this.createProp(null),this.selectedNoteViewChangedAction=this.createAction(this.selectedNoteViewChanged),this.selectedNoteViewProp.addAction(this.selectedNoteViewChangedAction),this.selectionDetailProp=this.createProp(this.selectionDetailText),this.selectionDetailStyle=this.createStyleProp("recap-selection-detail",[[t.editModeProp,"editable"]]),this.textSelectionProp=this.createProp(null),this.notesContainerStyle=this.createStyleProp("recap-notes-container",[[t.editModeProp,"editable"],[this.presentationProp,"presentation"]]),this.params.documentProp.addAction(this.createAction(this.documentChanged)),document.addEventListener("selectionchange",(e=>this.selectionChanged(e))),this.changedProp=this.createProp(!1),this.previousChangeProp=this.createProp(null),this.addChangeAction=this.createAction(this.addChange),this.selectedNoteChangedProp=this.createProp(!1),this.mainToolbarParams=this.initializeMainToolbarParams(),this.editToolbarContainerParams=this.initializeEditToolbarContainerParams(),this.noteViewParams=this.initializeNoteViewParams(),this.selectionDetailParams=this.initializeSelectionDetailParams(),this.extensionParams=this.initializeExtensionParams(),h.default.initialize(this.extensionParams)}documentChanged(){this.selectedNoteViewProp.set(null),this.indexOfSelectedNoteViewProp.set(-1)}selectionChanged(e){this.textSelectionProp.set(window.getSelection())}initializeMainToolbarParams(){return{collapseAllAction:this.createAction(this.collapseAll,this.someViewsAreExpanded),decreaseSizeAction:this.createAction(this.decreaseSize,this.scaleFactorMayDecrease),expandAllAction:this.createAction(this.expandAll,this.someViewsAreCollapsed),goDownAction:this.createAction(this.goDown,this.moreViewsAreBelow),goUpAction:this.createAction(this.goUp,this.moreViewsAreAbove),increaseSizeAction:this.createAction(this.increaseSize,this.scaleFactorMayIncrease),quickPickAction:this.params.quickPickAction,toggleEditAction:this.createAction(this.toggleEdit),toggleViewAction:this.createAction(this.toggleView),viewHelpAction:this.createAction(this.viewHelp),exportWebBundleAction:this.createAction(this.exportWebBundle),publishToGithubPagesAction:this.createAction(this.publishToGithubPages),editModeProp:this.params.editModeProp,presentationProp:this.presentationProp,style:g.default.defaultStyle}}initializeEditToolbarContainerParams(){return{addNoteAction:this.createAction(this.addNote),deleteNoteAction:this.createAction(this.deleteNote),createMarkdownLinkAction:this.createAction(this.createMarkdownLink),createNoteLinkAction:this.createAction(this.createNoteLink,this.mostRecentSelectionIsValid),moveDownAction:this.createAction(this.moveDown,this.moreViewsAreBelow),moveUpAction:this.createAction(this.moveUp,this.moreViewsAreAbove)}}initializeNoteViewParams(){return{...this.editToolbarContainerParams,editModeProp:this.params.editModeProp,expandedNoteViewsProp:this.expandedNoteViewsProp,presentationProp:this.presentationProp,rootPathProp:this.params.rootPathProp,selectedNoteViewProp:this.selectedNoteViewProp,mostRecentSelectionProp:this.mostRecentSelectionProp,textSelectionProp:this.textSelectionProp,changedProp:this.changedProp,previousChangeProp:this.previousChangeProp,addChangeAction:this.addChangeAction,annotationsProp:this.params.annotationsProp,selectedNoteChangedProp:this.selectedNoteChangedProp,note:u.default.emptyNote}}initializeSelectionDetailParams(){return{style:this.selectionDetailStyle,label:this.selectionDetailProp}}initializeExtensionParams(){return{documentProp:this.params.documentProp,editModeProp:this.params.editModeProp,mostRecentSelectionProp:this.mostRecentSelectionProp,outputFileSpacingProp:this.params.outputFileSpacingProp,addNoteAction:this.editToolbarContainerParams.addNoteAction,createNoteLinkAction:this.editToolbarContainerParams.createNoteLinkAction,documentWasSavedAction:this.createAction(this.documentWasSaved),exportWebBundleToFolderAction:this.createAction(this.exportWebBundle),publishToGithubPagesAction:this.createAction(this.publishToGithubPages),goDownAction:this.mainToolbarParams.goDownAction,goUpAction:this.mainToolbarParams.goUpAction,prepareToSaveAction:this.createAction(this.prepareToSave),redoAction:this.createAction(this.redo),revertAction:this.params.revertAction,showMarkdownLinkAction:this.createAction(this.showMarkdownLink),toggleEditAction:this.mainToolbarParams.toggleEditAction,undoAction:this.createAction(this.undo),viewChangedAction:this.createAction(this.viewChanged),viewHiddenAction:this.createAction(this.viewHidden)}}noteViews(){return this.children.filter((e=>e instanceof a.default))}document(){return this.params.documentProp.get()}rootPath(){return n.default.valueof(this.params.rootPathProp)}documentIsEmpty(){return this.documentIsValid()&&this.document().isEmpty()}documentIsValid(){return this.document()?.isValid()}currentStyle(){return this.documentIsValid()?"recap-top":"recap-top-invalid"}render(){const e=this.document();e&&(e.isValid()?(this.params.annotationsProp.get().forEach(((e,t)=>{this.addChild({name:"noteview-"+e.id,viewClass:a.default,params:{...this.noteViewParams,note:e}})})),this.addChild({name:"selection-panel",viewClass:o.default,params:this.selectionDetailParams}),this.addChild({name:"main-toolbar",viewClass:l.default,params:this.mainToolbarParams}),r.default.deviceIsIOS()?(this.addWrapping("toolbar-container","","main-toolbar"),this.addWrapping("notes-container",this.notesContainerStyle,/noteview-*/)):(this.addWrapping("notes-container",this.notesContainerStyle,/noteview-*/),this.addWrapping("toolbar-container","","main-toolbar"))):this.setInnerText("Error: Document is not a valid recap file"))}afterRender(){p.default.isWebContext()||(this.document()!==d.default.nullDocument?this.documentIsEmpty()?this.addNote().toggleEdit():this.selectedNoteViewProp.get()||setTimeout((()=>this.firstNoteView()?.select().expand()),500):this.clearUndo())}selectedNoteView(){return this.selectedNoteViewProp.get()}selectedNote(){return this.selectedNoteView()?.note}setNoteChanged(e){this.selectedNote()&&this.selectedNoteChangedProp.set(e)}noteViewCount(){return this.noteViews().length}someViewsAreCollapsed(){return!this.inPresentationMode()&&this.expandedNoteViewsProp.get().size<this.noteViewCount()}someViewsAreExpanded(){return!this.inPresentationMode()&&this.expandedNoteViewsProp.get().size>0}scaleFactorMayDecrease(){return this.scaleFactor.get()>m.minScaleFactor}scaleFactorMayIncrease(){return this.scaleFactor.get()<m.maxScaleFactor}moreViewsAreAbove(){return this.selectedNoteView()&&this.indexOfSelectedNoteViewProp.get()>0}moreViewsAreBelow(){return this.selectedNoteView()&&this.indexOfSelectedNoteViewProp.get()<this.noteViewCount()-1}selectedNoteViewChanged(){this.indexOfSelectedNoteViewProp.set(this.noteViews().indexOf(this.selectedNoteView()))}mostRecentSelectionIsValid(){return this.mostRecentSelectionProp.get().isValid()}selectionDetailText(){return"Selection: "+this.mostRecentSelectionProp.get().description("none")}showSelectedNoteView(){return this.selectedNoteView()?.scrollIntoViewIfNeeded(),this}collapseAll(){this.noteViews().forEach((e=>e.collapse())),this.showSelectedNoteView()}expandAll(){this.noteViews().forEach((e=>e.expand())),this.showSelectedNoteView()}changeSize(e){return this.scaleFactor.set(this.scaleFactor.get()+e),this.setCSSProperty("--font-size-scaled",100*this.scaleFactor.get()+"%"),this}decreaseSize(){this.scaleFactorMayDecrease()&&this.changeSize(-.1)}increaseSize(){this.scaleFactorMayIncrease()&&this.changeSize(.1)}goDown(e){e?.altKey?this.lastNoteView().select().expand():this.moreViewsAreBelow()&&this.selectedNoteView().nextSiblingView().select().expand()}goUp(e){e?.altKey?this.firstNoteView().select().expand():this.moreViewsAreAbove()&&this.selectedNoteView().previousSiblingView().select().expand()}exportWebBundle(){p.default.exportRecapFiles()}publishToGithubPages(){p.default.publishToGithubPages()}viewHelp(){p.default.viewHelp()}toggleView(){this.inEditMode()&&this.toggleEdit(),this.presentationProp.toggle(!0,!1)}firstNoteView(){return n.default.firstOrNull(this.noteViews())}lastNoteView(){return n.default.last(this.noteViews())}inEditMode(){return this.params.editModeProp.get()}inPresentationMode(){return this.presentationProp.get()}handleClick(e){this.eventTargetIsSelf(e)&&!this.inPresentationMode()&&this.selectedNoteView()?.deselect()}toggleEdit(){this.inPresentationMode()&&this.toggleView(),this.inEditMode()&&this.prepareToSave(),this.params.editModeProp.toggle(!0,!1),this.showSelectedNoteView()}addNote(){const e=this.document().createNewNote();return this.addNoteAtIndex(e,this.indexOfSelectedNoteViewProp.get())}addNoteAtIndex(e,t){-1!==t&&this.noteViews()[t].select();const i=this.document(),s=i.addNoteAtIndex(e,t);this.params.annotationsProp.set(i.annotations);const o=this.noteViews().find((e=>e.note===s));return o.moveAfter(this.selectedNoteView()),setTimeout((()=>o.select().expand()),100),this.addNotesContainerChange("addNote",s,t),this}createMarkdownLink(){this.selectedNoteView()?.createMarkdownLink()}createNoteLink(){this.selectedNoteView()?.createNoteLink()}deleteNote(){const e=this.document(),t=this.selectedNoteView().note,i=e.annotations.indexOf(t);e.deleteNote(t),this.params.annotationsProp.set(e.annotations),this.selectedNoteViewChanged(),this.addNotesContainerChange("deleteNote",t,i)}moveUp(){const e=this.document(),t=this.selectedNoteView().note;e.moveNoteUp(t),this.params.annotationsProp.set(e.annotations),this.selectedNoteView().moveBeforePreviousSibling(),this.selectedNoteViewChanged(),this.addNotesContainerChange("moveUp",t)}moveDown(){const e=this.document(),t=this.selectedNoteView().note;e.moveNoteDown(this.selectedNoteView()?.note),this.params.annotationsProp.set(e.annotations),this.selectedNoteView().moveAfterNextSibling(),this.selectedNoteViewChanged(),this.addNotesContainerChange("moveDown",t)}prepareToSave(){this.selectedNoteView()?.prepareToSave()}showMarkdownLink(e){const t=this.selectedNoteView()?.note;if(t){const i=t.markdownLinkTargets.find((t=>t.matches(e)));i&&(e.targetText=i.targetText,e.targetOffset=i.targetOffset)}p.default.showLink(e)}viewChanged(){this.selectedNoteView()?.select()}viewHidden(){}clearUndo(){this.undoStack=[],this.redoStack=[],this.selectedNoteChangedProp.set(!1),this.previousChangeProp.set(null)}isChanged(){return this.changedProp.get()}setChanged(e){this.changedProp.set(e),this.document().changed=e}documentWasSaved(){this.clearUndo(),this.setChanged(!1)}getChangeOwner(e){if("NotesContainer"===e.ownerClass)return this;const t=this.childNamed("noteview-"+e.ownerID);return"NoteView"===e.ownerClass?t:t?.textView()}addNotesContainerChange(e,t,i=0){const s={ownerClass:"NotesContainer",ownerID:0,type:e,note:t,index:i};this.addChange(s)}addChange(e){this.inUndoOrRedo||(this.undoStack.push(e),p.default.documentChanged(),this.setChanged(!0),this.previousChangeProp.set(e),this.setNoteChanged(!0))}countChangesFor(e){return n.default.count(this.undoStack,(t=>this.getChangeOwner(t)===e))}undo(){if(0===this.undoStack.length)return;const e=this.undoStack.pop();this.inUndoOrRedo=!0;const t=this.getChangeOwner(e);t.undoChange(e),this.inUndoOrRedo=!1,this.redoStack.push(e),this.setChanged(this.undoStack.length>0),this.setNoteChanged(this.countChangesFor(t)>0),this.previousChangeProp.set(null)}redo(){if(0===this.redoStack.length)return;const e=this.redoStack.pop();this.inUndoOrRedo=!0,this.getChangeOwner(e).redoChange(e),this.inUndoOrRedo=!1,this.addChange(e)}undoChange(e){if("deleteNote"===e.type)return void this.addNoteAtIndex(e.note,e.index);const t=this.noteViews().find((t=>t.note===e.note));t&&(t.select(),"addNote"===e.type?this.deleteNote():"moveUp"===e.type?this.moveDown():"moveDown"===e.type&&this.moveUp())}redoChange(e){if("addNote"===e.type)return void this.addNoteAtIndex(e.note,e.index);const t=this.noteViews().find((t=>t.note===e.note));t&&(t.select(),"deleteNote"===e.type?this.deleteNote():"moveUp"===e.type?this.moveUp():"moveDown"===e.type&&this.moveDown())}}m.defaultStyle="recap-top",m.minScaleFactor=.8,m.maxScaleFactor=2,t.default=m},697:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(813);class r extends s.default{constructor(e,t){super(e,t),this.clickAction=t.clickAction,this.codicon=t.codicon,this.hoverText=t.hoverText,o.default.isString(t.style)&&t.clickAction&&(this.style=this.createStyleProp(t.style,[[t.clickAction.disabledProp(),"disabled"]])),t.clickAction&&this.setClickAction(this.handleClick)}render(){this.setTitle(o.default.valueof(this.hoverText)),this.addDecoration("codicon","codicon "+o.default.valueof(this.codicon))}handleClick(e){this.clickAction?.isEnabled()&&(this.makeInvisibleForMilliseconds(200),this.clickAction.performWith(e),e.stopPropagation())}}r.defaultStyle="recap-toolbar-button",t.default=r},574:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RecapPopUp=t.PopUpPositionType=void 0;const s=i(928),o=i(974);var r;!function(e){e[e.cursor=0]="cursor",e[e.center=1]="center"}(r=t.PopUpPositionType||(t.PopUpPositionType={}));class n extends s.default{constructor(e,t){super(e,t),this.params=t,this.params.visibleProp.addAction(this.createAction(this.visibilityChanged)),this.windowClickHandler=this.handleWindowClick.bind(this),this.setEventActions({keydown:this.handleKeyDown}),this.setTabIndex(0)}handleWindowClick(){this.close()}handleKeyDown(e){"Escape"===e.key&&this.close()}visibilityChanged(e){e?(window.addEventListener("click",this.windowClickHandler),this.focus()):window.removeEventListener("click",this.windowClickHandler)}applyStyle(){super.applyStyle();const e=this.clientRect(),t=this.params.positionProp.get();switch(this.params.positionTypeProp.get()){case r.cursor:return void this.setPosition(t.x-e.width+10,Math.max(10,t.y-e.height+10));case r.center:return void this.setPosition((window.innerWidth-e.width)/2,(window.innerHeight-e.height)/2)}}render(){this.params.itemsProp.get().forEach(((e,t)=>{this.addChild({name:"item-"+t,viewClass:o.default,params:{label:e,style:this.params.itemStyle,clickAction:this.params.clickAction}})})),this.addWrapping("popup-container","recap-quick-pick-item-container",/item-*/)}close(){this.params.closeAction.perform()}}t.RecapPopUp=n,n.defaultStyle="",t.default=n},866:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(738),o=i(390),r=i(813),n=i(732);class a{static initialize(){s.ZStyle.initialize(),this.initializeZVars(),this.loadRecapStyles(),this.loadSmallStyles(),this.listenForThemeChanges()}static listenForThemeChanges(){n.default.isWebContext()&&(this.mediaChangeHandler=this.handleDarkModeChange.bind(this),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",this.mediaChangeHandler))}static handleDarkModeChange(e){s.ZStyle.setColorTheme(n.default.inWebDarkMode()?"dark":"light")}static loadRecapStyles(){s.ZStyle.loadAtoms(this.recapAtomSpecs),this.recapStyleSpecs.forEach((e=>{const t=e[0],i=e[1].split(/\s+/),o={};i.forEach((e=>{const i=s.ZStyle.atoms.get(e);if(i)Object.assign(o,i);else{const i=s.ZStyle.named(e);i&&i.name?Object.assign(o,i.props):console.log(`${t}: invalid atom or style name: ${e}`)}})),s.ZStyle.create(t,o)}))}static loadSmallStyles(){s.ZStyle.addRule("@media screen and (max-width: 45em)",".display-none-s { display: none } .height-100-s { height: calc(100vh - 44px) }")}static vscodeThemeDefaults(){return{fontFamilyDefault:s.ZStyle.getRootProperty("--vscode-editor-font-family"),fontSizeDefault:s.ZStyle.getRootProperty("--vscode-editor-font-size"),colorDefault:s.ZStyle.getRootProperty("--vscode-foreground"),colorSelection:s.ZStyle.getRootProperty("--vscode-editorLink-activeForeground"),colorBorder:s.ZStyle.getRootProperty("--vscode-editor-foreground"),bgColorDefault:s.ZStyle.getRootProperty("--vscode-editor-background"),bgColorButton:s.ZStyle.getRootProperty("--vscode-editorWidget-background")}}static addZVar(e,t){this.zvars.add(o.default.create(e,t))}static camelToKebab(e){return`--${r.default.kebabize(e)}`}static themeValue(e){const t=s.ZStyle.inDarkMode();return(n.default.vscode?this.vscodeThemeDefaults():t?this.darkThemeDefaults:this.lightThemeDefaults)[e]}static initializeZVars(){Object.keys(this.darkThemeDefaults).forEach((e=>{this.addZVar(this.camelToKebab(e),(()=>this.themeValue(e)))})),this.basicZVarSpecs.forEach((([e,t])=>{this.addZVar(e,t)})),s.ZStyle.addRule("h1, h2","padding-bottom: 10px")}}a.allStyles={},a.recapStyleSpecs=[["recap-web-root","display-flex width-100 height-100 bg-color-default overflow-hidden"],["webview","pos-relative width-50 height-100 bg-color-default height-100-s"],["link-target-view","width-50 height-100 bg-color-default margin-left-05 ws-pre color-default \n      font-family-default overflow-y-scroll"],["recap-top","display-flex flex-column height-100 bg-color-default color-default font-family-default \n      font-size-scaled margin-0 pad-0 overflow-hidden"],["recap-top-invalid","width-75 height-100 display-flex flex-column justify-center font-size-error \n      margin-auto margin-left-2 color-error"],["recap-notes-container-base","display-block flex-grow-1 overflow-y-scroll"],["recap-notes-container","recap-notes-container-base pad-bottom-2 height-100-22"],["recap-notes-container-editable","recap-notes-container-base pad-bottom-4 height-100-35"],["recap-notes-container-presentation","display-flex flex-column overflow-y-scroll height-100-22"],["recap-selection-detail","display-none"],["recap-selection-detail-editable","pos-fixed width-100 display-block font-size-small bottom-2 border-top-1 border-left-1\n       border-bottom-1 border-color-gray pad-025 text-align-center overflow-hidden color-selection bg-color-button"],["recap-selection-detail-editable-alert","recap-selection-detail-editable color-alert"],["recap-edit-toolbar","width-100 display-flex flex-row font-size-normal justify-between border-top-1 \n      border-color-gray margin-top-1 pad-left-05 bg-color-button overflow-hidden"],["recap-link-detail","font-size-small text-align-left pad-025 pad-left-2 pad-right-2 pad-top-025 truncate display-none-s"],["recap-text-container","display-flex flex-row pad-bottom-025 outline-0"],["recap-text-container:focus-visible","outline-0"],["recap-text","cursor-pointer width-100 truncate outline-0"],["recap-text:focus-visible","outline-0"],["recap-text-expanded","cursor-pointer width-100 ws-normal overflow-break-word width-100 outline-0"],["recap-text-expanded:focus-visible","outline-0"],["recap-text-editable","font-size-default cursor-auto margin-left-05 ws-pre-wrap width-100 max-height-70 outline-0"],["recap-text-editable:focus-visible","outline-0"],["recap-text-presentation","cursor-pointer ws-normal margin-auto pad-1 outline-0"],["recap-text-presentation:focus-visible","outline-0"],["disclosure","margin-025"],["disclosure-single","display-none"],["disclosure-editable","display-none"],["disclosure-presentation","display-none"],["recap-note-base","margin-05 pad-top-025 text-align-left pos-relative overflow-hidden cursor-pointer"],["recap-note","recap-note-base display-block opacity-70 border-style-none"],["recap-note-presentation","display-none"],["recap-note-presentation-selected","pad-top-025 text-align-left pos-relative  cursor-pointer display-block \n      border-style-none opacity-100 margin-auto"],["recap-note-selected","recap-note-base border-1 border-radius-05 border-width-0125 opacity-100"],["recap-note-linked","border-style-solid"],["recap-note-unlinked","border-style-dotted"],["recap-note-changed","border-color-selection border-left-edited"],["recap-note-unchanged","border-color-selection"],["recap-note-noborder","border-style-none"],["recap-toolbar","display-flex flex-row font-size-normal bottom-0 justify-between pad-025 pad-left-05 border-1\n       border-color-gray bg-color-button overflow-hidden width-100"],["recap-toolbar-container","pad-0"],["recap-button-group","display-flex flex-row pad-right-05"],["recap-button-group-grow-1","display-flex flex-grow-1 flex-row"],["recap-button-base","width-15 bg-color-inherit border-style-none margin-right-025 margin-top-025 pad-top-025 color-default"],["recap-toolbar-button","recap-button-base scale-12"],["recap-toolbar-button:hover","cursor-pointer color-green"],["recap-edit-button","recap-button-base"],["recap-toolbar-button-editable","recap-button-base color-red"],["recap-toolbar-button-disabled","recap-button-base scale-12 cursor-auto opacity-30"],["recap-quick-pick","display-block z-index-999 pos-fixed top-0 left-100 bg-color-lightgray border-1 border-radius-05"],["recap-quick-pick-item-container","max-height-30 margin-025"],["recap-quick-pick-item","font-size-normal color-black-o90 margin-025"],["recap-quick-pick-item:hover","cursor-pointer color-blue"],["recap-quick-pick-hidden","display-none"],["recap-centered-title","display-block width-100 text-align-center margin-bottom-1"],["recap-modal","pos-fixed left-0 top-0 width-100 height-100 z-index-1 bg-color-gray-o30"]],a.recapAtomSpecs=[["bg-color-default","background-color: var(--bg-color-default)"],["bg-color-inherit","background-color: inherit"],["bg-color-green","background-color: var(--color-green)"],["bg-color-blue","background-color: var(--color-blue)"],["bg-color-button","background-color: var(--bg-color-button)"],["bg-color-gray","background-color: var(--color-gray)"],["bg-color-lightgray","background-color: var(--color-lightgray)"],["bg-color-gray-o30","background-color: var(--color-gray-o30)"],["border-color-gray","border-color: var(--color-gray)"],["border-color-selection","border-color: var(--color-selection)"],["border-radius-05","border-radius: 0.5rem"],["border-style-dotted","border-style: dotted"],["border-style-solid","border-style: solid"],["border-width-0125","border-width: .125rem"],["bottom-0","bottom: 0"],["bottom-2","bottom: 2rem"],["color-default","color: var(--color-default)"],["color-error","color: var(--color-error)"],["color-alert","color: var(--color-alert)"],["color-selection","color: var(--color-selection)"],["color-black-o90","color: var(--color-black-o90)"],["color-red","color: var(--color-red)"],["color-green","color: var(--color-green)"],["color-blue","color: var(--color-blue)"],["cursor-auto","cursor: auto"],["cursor-pointer","cursor: pointer"],["display-block","display: block"],["display-flex","display: flex"],["display-none","display: none"],["flex-row","flex-direction: row"],["flex-column","flex-direction: column"],["flex-grow-1","flex-grow: 1"],["font-family-default","font-family: var(--font-family-default)"],["font-family-sans-serif","font-family: sans-serif"],["font-family-serif","font-family: serif"],["font-size-default","font-size: var(--font-size-default)"],["font-size-scaled","font-size: var(--font-size-scaled)"],["font-size-error","font-size: var(--font-size-error)"],["font-size-small","font-size: var(--font-size-small)"],["font-size-normal","font-size: var(--font-size-normal)"],["font-size-large","font-size: var(--font-size-large)"],["height-100","height: 100vh"],["justify-between","justify-content: space-between"],["justify-center","justify-content: center"],["justify-right","justify-content: right"],["left-0","left: 0"],["left-100","left: 100px"],["margin-auto","margin: auto"],["margin-0","margin: 0"],["margin-025","margin: 0.25rem"],["margin-05","margin: 0.5rem"],["margin-bottom-1","margin-bottom: 1rem"],["margin-left-05","margin-left: 0.5rem"],["margin-left-2","margin-left: 2rem"],["margin-right-025","margin-right: 0.25rem"],["margin-right-05","margin-right: 0.5rem"],["margin-top-025","margin-top: 0.25rem"],["margin-top-05","margin-top: 0.5rem"],["margin-top-1","margin-top: 1rem"],["opacity-30","opacity: 0.3"],["opacity-70","opacity: 0.7"],["opacity-100","opacity: 1.0"],["outline-0","outline: 0"],["overflow-break-word","overflow-wrap: break-word"],["overflow-hidden","overflow: hidden"],["overflow-y-scroll","overflow-y: scroll"],["pad-0","padding: 0"],["pad-025","padding: 0.25rem"],["pad-05","padding: 0.5rem"],["pad-1","padding: 1rem"],["pad-bottom-025","padding-bottom: 0.25rem"],["pad-bottom-2","padding-bottom: 2rem"],["pad-bottom-4","padding-bottom: 4rem"],["pad-left-05","padding-left: 0.5rem"],["pad-left-2","padding-left: 2rem"],["pad-right-05","padding-right: 0.5rem"],["pad-right-2","padding-right: 2rem"],["pad-top-025","padding-right: 0.25rem"],["pos-absolute","position: absolute"],["pos-fixed","position: fixed"],["pos-relative","position: relative"],["scale-12","transform: scale(1.2)"],["text-align-center","text-align: center"],["text-align-left","text-align: left"],["top-0","top: 0"],["width-100","width: 100%"],["width-75","width: 75%"],["width-50","width: 50%"],["width-15","width: 1.5em"],["ws-pre","white-space: pre"],["ws-normal","white-space: normal"],["ws-pre-wrap","white-space: pre-wrap"],["z-index-1","z-index: 1"],["z-index-999","z-index: 999"],["border-1","border-style: solid; border-width: 1px"],["border-bottom-1","border-bottom-style: solid; border-bottom-width: 1px"],["border-left-edited","border-left-color:#ff4136;border-left-width:2px;border-left-style:solid"],["border-left-1","border-left-style: solid; border-left-width: 1px"],["border-style-none","border-style: none; border-width: 0"],["border-top-1","border-top-style: solid; border-top-width: 1px"],["center-child","position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)"],["height-100-22","height: calc(100vh - 2.2rem)"],["height-100-35","height: calc(100vh - 3.5rem)"],["mark","background-color:#3BC2EB;color:black"],["max-height-30","max-height:30vh;overflow-y:scroll"],["max-height-70","max-height:70vh;overflow-y:scroll"],["recap-centered-title","display:block;width:100%;text-align:center;margin-bottom:1.5rem"],["shadow-1","box-shadow: 0 0 4px 2px rgba(0,0,0,0.2)"],["shadow-3","box-shadow: 2px 2px 4px 2px rgba(0,0,0,0.2)"],["truncate","white-space:nowrap;overflow:hidden;text-overflow:ellipsis"],["display-none-s",""],["height-100-s",""]],a.darkThemeDefaults={fontFamilyDefault:'Menlo, Monaco, "Courier New", monospace',fontSizeDefault:"14px",colorDefault:"#cccccc",colorSelection:"#4e94ce",colorBorder:"#d4d4d4",bgColorDefault:"#1e1e1e",bgColorButton:"#252526"},a.lightThemeDefaults={fontFamilyDefault:'Menlo, Monaco, "Courier New", monospace',fontSizeDefault:"14px",colorDefault:"#616161",colorSelection:"#0000ff",colorBorder:"#000000",bgColorDefault:"#ffffff",bgColorButton:"#f3f3f3"},a.basicZVarSpecs=[["--color-error","orange"],["--color-alert","red"],["--color-gray","#777"],["--color-gray-o30","rgba(128,128,128,0.3)"],["--color-lightgray","#E8E8E8"],["--color-black-o90","rgba(0,0,0,0.9)"],["--color-red","#ff4136"],["--color-green","#19a974"],["--color-blue","#aed1fe"],["--font-size-error","1.25rem"],["--font-size-scaled","100%"],["--font-size-small","0.875rem"],["--font-size-normal","1.0rem"],["--font-size-large","1.25rem"]],a.zvars=new Set,t.default=a},382:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(974),r=i(697);class n extends s.default{buttonStyle(){return"recap-toolbar-button"}addButton(e,t,i,s,o=""){const n={style:o||this.buttonStyle(),codicon:"codicon-"+t,hoverText:i,clickAction:s};return this.addChild({name:e,viewClass:r.default,params:n}),this}addBlank(e){return this.addButton("blank-"+e,"blank","",void 0,void 0)}addText(e,t,i=""){const s={style:t,label:i};return this.addChild({name:e,viewClass:o.default,params:s}),this}}n.defaultStyle="recap-toolbar",t.default=n},935:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(602),r=i(361),n=i(817),a=i(732),l=i(363);class c extends s.default{constructor(e,t,i="body"){super(e,t,i),this.linkTargetProp=this.createProp(null),this.recapList=[],this.currentRecapIndex=0,this.params=t,this.webviewParams={style:o.default.defaultStyle,switchRecapAction:this.createAction(this.loadRecapFile)},this.linkTargetParams={linkTargetProp:this.linkTargetProp},a.default.showLinkAction=this.createAction(this.showLink)}static openOn(e,t){const i={style:this.defaultStyle};s.default.createRootView(c,i).openWithRecapList(e,t)}openWithRecapList(e,t){this.recapList=t;const i=t.find((e=>e.path.endsWith("index.recap")));e?this.loadRecapFile(e):i?this.loadRecapFile(i.path):this.loadRecapFile(t[0].path)}async showLink(e){if(!e.file)return void this.linkTargetProp.set(r.default.emptyLinkTarget);const t=await fetch("../"+e.file);t.ok?(e.text=await t.text(),e.html=l.default.highlight(e.text)):e.html="Target file not found: "+e.file,this.linkTargetProp.set(e)}render(){this.addChild({name:"webview",viewClass:o.default,params:this.webviewParams}),this.addChild({name:"linkTargetView",viewClass:n.default,params:this.linkTargetParams})}async loadRecapFile(e){const t=await fetch("../"+e),i=await t.text();this.loadRecap(i)}async loadRecap(e){const t=a.default.inWebDarkMode()?"dark":"light",i={includeTargetText:!1,allRecapFiles:this.recapList.map((e=>e.path)),outputFileSpacing:2,rootPath:"../",runtime:!1,targetTextLength:40,colorTheme:t,pluginFileNames:["markdown-it-deflist.min.js","markdown-it-emoji.min.js","markdown-it-footnote.min.js","markdown-it-sub.min.js","markdown-it-sup.min.js"],contents:e};window.postMessage({type:"init",body:i},window.location.origin)}}c.defaultStyle="recap-web-root",t.default=c},602:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(738),r=i(412),n=i(694),a=i(732),l=i(896),c=i(363),d=i(574);class h extends s.default{constructor(e,t,i){super(e,t,i),this.params=t,this.documentProp=this.createProp(null),this.editModeProp=this.createProp(!1),this.annotationsProp=this.createProp([]),this.mayQuickPickProp=this.createProp(!1),this.allRecapFilesProp=this.createProp([]),this.rootPathProp=this.createProp(""),this.runtimeProp=this.createProp(!1),this.quickPickItemsProp=this.createProp([]),this.quickPickVisibleProp=this.createProp(!1),this.quickPickPositionProp=this.createProp({x:0,y:0}),this.quickPickPositionTypeProp=this.createProp(d.PopUpPositionType.cursor),this.quickPickStyle=this.createProp(this.currentRecapQuickPickStyle),this.includeTargetTextProp=this.createProp(!1),this.targetTextLengthProp=this.createProp(40),this.outputFileSpacingProp=this.createProp(0),this.initializeNotesContainerParams(),this.initializeExtensionParams(),this.initializeRecapQuickPickParams(),l.default.initialize(this.rootExtensionParams)}initializeNotesContainerParams(){this.notesContainerParams={annotationsProp:this.annotationsProp,documentProp:this.documentProp,editModeProp:this.editModeProp,outputFileSpacingProp:this.outputFileSpacingProp,quickPickAction:this.createAction(this.quickPickRecapFile,this.mayQuickPickProp),revertAction:this.createAction(this.revert),rootPathProp:this.rootPathProp}}initializeExtensionParams(){this.rootExtensionParams={initWebViewAction:this.createAction(this.initWebView),updateConfigAction:this.createAction(this.updateConfig),quickPickAction:this.createAction(this.quickPickRecapFile)}}initializeRecapQuickPickParams(){this.recapQuickPickParams={style:this.quickPickStyle,itemsProp:this.quickPickItemsProp,itemStyle:"recap-quick-pick-item",clickAction:this.createAction(this.handleRecapQuickPick),closeAction:this.createAction(this.hideRecapQuickPick),positionProp:this.quickPickPositionProp,positionTypeProp:this.quickPickPositionTypeProp,visibleProp:this.quickPickVisibleProp}}render(){this.addChild({name:"notes-container",viewClass:r.default,params:this.notesContainerParams}),this.addChild({name:"recap-quickpick",viewClass:d.RecapPopUp,params:this.recapQuickPickParams}),this.addModalWrapping("quickpick-wrapper","recap-modal",this.quickPickVisibleProp,"recap-quickpick")}initWebView(e){this.includeTargetTextProp.set(e.includeTargetText),this.allRecapFilesProp.set(e.allRecapFiles),this.mayQuickPickProp.set(e.allRecapFiles.length>1),this.outputFileSpacingProp.set(e.outputFileSpacing),this.rootPathProp.set(e.rootPath),this.runtimeProp.set(e.runtime),this.targetTextLengthProp.set(e.targetTextLength),o.default.setColorTheme(e.colorTheme),c.default.pluginFileNames=e.pluginFileNames||[],this.loadRecapDocument(e.contents,e.fileName)}documentWasLoaded(e){this.documentProp.set(e)}updateConfig({includeTargetText:e,targetTextLength:t,outputFileSpacing:i,colorTheme:s}){this.includeTargetTextProp.set(e),this.targetTextLengthProp.set(t),this.outputFileSpacingProp.set(i),o.default.setColorTheme(s)}currentRecapQuickPickStyle(){return this.quickPickVisibleProp.get()?"recap-quick-pick":"recap-quick-pick-hidden"}quickPickRecapFile(e){this.quickPickItemsProp.set(this.allRecapFilesProp.get()),e?this.showRecapQuickPickAtCursor(e):this.showRecapQuickPick()}showRecapQuickPickAtCursor(e){this.quickPickVisibleProp.set(!0),this.quickPickPositionTypeProp.set(d.PopUpPositionType.cursor),this.quickPickPositionProp.set({x:e.clientX,y:e.clientY})}showRecapQuickPick(){this.quickPickVisibleProp.set(!0),this.quickPickPositionTypeProp.set(d.PopUpPositionType.center)}handleRecapQuickPick(e){this.hideRecapQuickPick(),a.default.isWebContext()?this.params.switchRecapAction?.performWith(e):a.default.openOtherRecapFile(e)}hideRecapQuickPick(){this.quickPickVisibleProp.set(!1)}loadRecapDocument(e,t){this.documentProp.set(n.default.nullDocument),this.annotationsProp.set([]);const i=new n.default(e);t&&i.setFileName(t),this.documentProp.set(i),this.annotationsProp.set(i.annotations)}revert(e){this.loadRecapDocument(e)}}h.defaultStyle="webview",t.default=h},407:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(904),o=i(813);class r{constructor(e,t,i=!0){this.valid=!0,this.owner=e,this.enabled=i instanceof s.default?i:s.default.create(i,e),this.callback=t.bind(e),this.args=[],this.valid=!0,this.dependentProps=new Set}static create(e,t,i=!0){return new r(e,t,i)}release(){this.valid=!1,this.enabled.release(),this.dependentProps.forEach((e=>e.removeAction(this))),this.dependentProps=new Set}addDependentProp(e){this.dependentProps.add(e)}removeDependentProp(e){this.dependentProps.delete(e)}setEnabled(e){o.default.isFunction(e)?this.enabled.set(e.bind(this.owner)):this.enabled.set(e)}enabledProp(){return this.enabled}disabledProp(){return this.enabled.negated()}enable(){this.setEnabled(!0)}disable(){this.setEnabled(!1)}isEnabled(){return this.enabled.get()}isDisabled(){return!this.isEnabled()}disableWhile(e){const t=this.enabled;t&&this.disable(),e(),this.setEnabled(t.value())}perform(){this.performWith(...this.args)}performWith(...e){this.valid&&this.isEnabled()&&this.callback(...this.args,...e)}with(...e){const t=o.default.clone(this);return t.args=e,t}}t.default=r},788:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ZDisclosure=void 0;const s=i(928),o=i(813);class r extends s.default{constructor(e,t){super(e,t,r.defaultTagName),this.toggleHandler=this.handleToggle.bind(this),this.openProp=t.openProp,this.toggleAction=t.toggleAction,this.style=t.style,this.openProp.addAction(this.createAction(this.update)),this.addEventListener("toggle",this.toggleHandler)}update(){this.removeEventListener("toggle",this.toggleHandler),o.default.valueof(this.openProp)?this.setAttribute("open",""):this.removeAttribute("open"),setTimeout((()=>this.addEventListener("toggle",this.toggleHandler)),100)}handleToggle(){this.toggleAction?.performWith(this.openProp?.get())}createSummary(){this.summary=document.createElement("summary"),this.summary.innerText="",this.elt.appendChild(this.summary)}render(){this.summary||this.createSummary()}}t.ZDisclosure=r,r.defaultStyle="",r.defaultTagName="details",t.default=r},961:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t){this.start=e,this.end=t}static create(e,t){return new i(e,t)}isNull(){return-1===this.start&&-1===this.end}boundedBy(e,t){return e>this.end||t<this.start?i.nullInterval:new i(Math.max(this.start,e),Math.min(this.end,t))}}i.nullInterval=new i(-1,-1),t.default=i},974:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(813);class r extends s.default{constructor(e,t){super(e,t),this.label="",this.params=t,t.clickAction&&this.setClickAction(this.handleClick)}render(){this.setInnerText(this.value())}handleClick(){this.params.clickAction?.performWith(this.value())}value(){return o.default.valueof(this.params.label)}}r.defaultStyle="",t.default=r},904:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(928),o=i(390),r=i(813);class n{constructor(e,t){this.fn=null,this.fireOnAnySet=!1,this.id=n.nextID(),r.default.isFunction(e)?(this.fn=e,this.fn=this.fn.bind(t),this.val=this.fn()):this.val=e,this.owner=t,this.actions=new Set,this.fireOnAnySet=!1}static create(e,t){return new n(e,t)}static addToSet(e,t){const i=e.get();if(!i.has(t)){const s=[...Array.from(i),t];e.set(new Set(s))}}static deleteFromSet(e,t){const i=e.get();if(i.has(t)){i.delete(t);const s=Array.from(i);e.set(new Set(s))}}static nextID(){return this._nextID=this._nextID+1,this._nextID}release(){this.actions.forEach((e=>e.removeDependentProp(this))),this.actions=new Set}value(){return this.val}addActions(){const e=s.default.renderingView();e&&this.addAction(e.renderAction),o.default.currentZVar&&this.addAction(o.default.currentZVar.updateAction)}get(){return this.addActions(),this.fn?this.fn():this.val}set(e){return(e!==this.val||this.fireOnAnySet)&&(this.val=e,this.performActions()),this}performActions(){this.actions||console.log("no actions"),this.actions.forEach((e=>e.performWith(this.val)))}toggle(e,t){return this.set(this.value()===e?t:e),this}addAction(e){e||console.log("null action"),e&&(this.actions||console.log("empty actions"),this.actions.add(e),e.addDependentProp(this))}removeAction(e){this.actions.delete(e)}asSimpleProp(){return{id:this.id,value:this.val}}negated(){return new n((()=>!this.get()),this.owner)}}n._nextID=1,t.default=n},738:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.ZStyle=void 0;const o=i(904);class r{constructor(e,t={}){this.name=e,this.props=t}static stylesheet(){if(!this.zstylesheet)if(document.adoptedStyleSheets)try{this.zstylesheet=new CSSStyleSheet,document.adoptedStyleSheets=[this.zstylesheet]}catch{this.zstylesheet=document.styleSheets[0]}else this.zstylesheet=document.styleSheets[0];return this.zstylesheet}static addRule(e,t){const i=this.stylesheet().cssRules.length;return this.stylesheet().insertRule(`${e}{${t}}`,i),this.stylesheet().cssRules[i]}static setProperty(e,t,i){e.style.setProperty(t,i)}static getProperty(e,t){return getComputedStyle(e).getPropertyValue(t)}static getRootProperty(e){return this.getProperty(document.body,e)}static setRootProperty(e,t){this.setProperty(document.body,e,t)}static loadAtoms(e){e.forEach((e=>{const t=e[0],i={};e[1]&&e[1].split(";").forEach((e=>{const t=e.indexOf(":");i[e.substring(0,t).trim()]=e.substring(t+1).trim()})),this.atoms.set(t,i)}))}static colorThemeProp(){return this._colorThemeProp||(this._colorThemeProp=o.default.create("",this)),this._colorThemeProp}static setColorTheme(e){this.colorThemeProp().set(e)}static getColorTheme(){return this.colorThemeProp().get()}static initialize(){["html","body","h1","h2","h3","h4","h5","h6","p"].forEach((e=>this.addRule(e,"margin: 0; padding: 0; border: 0; box-sizing: border-box"))),this.loadAtoms(this.basicAtomSpecs)}static inDarkMode(){return this.getColorTheme().toLowerCase().includes("dark")}static deviceIsIOS(){return!!/iPad|iPhone|iPod/.test(navigator.platform)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)}static create(e,t){const i=new r(e,t);if(e){const t="."===e[0]?e:"."+e;this.basicStyles.set(t,i),i.rule=this.addRule(t,i.asRule())}return i}static named(e){const t="."===e[0]?e:"."+e;return this.basicStyles.get(t)||this.emptyStyle}add(e){Object.assign(this.props,e)}merge(e,t){return r.create(e,Object.assign({},this.props,t))}asRule(){return Object.keys(this.props).map((e=>`${e}: ${this.props[e]}`)).join(";\n")}index(){return this.rule?Array.from(r.stylesheet().cssRules).indexOf(this.rule):-1}delete(){const e=this.index();-1!=e&&r.stylesheet().deleteRule(e)}}t.ZStyle=r,s=r,r.initialRuleCount=0,r.compositeStyles=new Map,r.basicStyles=new Map,r.atoms=new Map,r.basicAtomSpecs=[["hidden","display: none"]],r.emptyStyle=s.create("",{}),t.default=r},390:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(738),o=i(407),r=i(813);class n{constructor(e,t){this.cssVarName=e,this.val=t,this.updateAction=o.default.create(this,this.update),this.update()}static create(e,t){return new n(e,t)}update(){n.currentZVar=this,s.default.setRootProperty(this.cssVarName,r.default.valueof(this.val)),n.currentZVar=null}}n.currentZVar=null,t.default=n},928:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ZView=void 0;const s=i(738),o=i(407),r=i(904),n=i(961),a=i(813);class l{constructor(e,t={},i="div"){this.actions=[],this.children=[],this.childSpecs=[],this.decorations=[],this.decorationSpecs=[],this.eventActions={},this.isDecoration=!1,this.isWrapping=!1,this.parent=null,this.props=[],this.valid=!0,this.wrappedViewNames=[],this.wrappings=[],this.wrappingSpecs=[],this.name=e,this.params=t,this.elt="body"===i?document.body:document.createElement(i),this.style=t?.style||"",t.tabIndex&&(this.elt.tabIndex=t.tabIndex),this.elt["data-zaffre"]=this,this.valid=!0,this.renderAction=this.createAction(l.useScheduler?this.scheduleRender:this.fullRender),this.children=[],this.parent=null,this.props=[],this.actions=[],this.eventActions={},this.childSpecs=[],this.wrappings=[],this.wrappingSpecs=[],this.isWrapping=!1,this.wrappedViewNames=[],this.decorations=[],this.decorationSpecs=[],this.isDecoration=!1,this.renderAction||(this.renderAction=this.createAction(l.useScheduler?this.scheduleRender:this.fullRender))}static renderingView(){return a.default.last(this.renderStack)}static pushRenderView(e){this.renderStack.push(e)}static popRenderView(){return this.renderStack.pop()}scheduleRender(){0===l.viewsToRender.length&&setTimeout((()=>l.renderPendingViews()),10),l.viewsToRender.push(this)}static renderPendingViews(){this.viewsToRender.forEach((e=>e.fullRender())),this.viewsToRender=[]}static createRootView(e,t={}){const i=new e("root",t,"div");return document.body.appendChild(i.elt),i.fullRender(),this.rootView=i,i}addParams(e){Object.assign(this,e)}childNames(){return this.children.map((e=>e.name))}childNamed(e){return this.children.find((t=>t.name===e))}rootView(){return this.parent?this.parent.rootView():this}ancestorPath(){return this.parent?[...this.parent.ancestorPath(),this]:[this]}fullName(){return this.ancestorPath().map((e=>e.name)).join(".")}release(){this.valid=!1,this.props.forEach((e=>e.release())),this.children.forEach((e=>e.release()))}convertCallbackOrAction(e){return e instanceof o.default?e:this.createAction(e)}eventHandler(e,t){this.eventActions[e].performWith(t)}setClickAction(e){e&&this.setEventAction("click",this.convertCallbackOrAction(e))}setEventAction(e,t){return e&&t&&(this.eventActions[e]=this.convertCallbackOrAction(t),this.addEventListener(e,this.eventHandler.bind(this,e))),this}setEventActions(e){Object.keys(e).forEach((t=>this.setEventAction(t,e[t])))}enableOrDisableEventAction(e,t){this.eventActions[e]&&(t?this.addEventListener(e,this.eventHandler.bind(this,e)):this.removeEventListener(e,this.eventHandler.bind(this,e)))}createProp(e){const t=new r.default(e,this);return this.props.push(t),t}localPropValues(){return this.props.map((e=>e.asSimpleProp()))}allProps(){return[...this.props,...this.children.reduce(((e,t)=>[...e,...t.allProps()]),[])]}getPropWithID(e){return this.rootView().allProps().find((t=>t.id===e))}allPropValues(){return Object.fromEntries(this.allProps().map((e=>[e.id,e.get()])))}applyPropValues(e){this.allProps().forEach((t=>{t.id in e&&t.set(e[t.id])}))}createAction(e,t=!0){const i=o.default.create(this,e,t);return this.actions.push(i),i}applyStyle(){this.style&&this.setCSSClass(a.default.valueof(this.style))}applyDecorationAndWrapperStyles(){this.decorations.forEach((e=>e.applyStyle())),this.wrappings.forEach((e=>e.applyStyle()))}setCSSProperty(e,t){s.default.setProperty(this.elt,e,t)}concatStyleProps(e,t){return[e,...t.map((e=>e[0].get()?e[1]:"")).filter((e=>e))].join("-")}createStyleProp(e,t){return this.createProp((()=>this.concatStyleProps(e,t)))}makeInvisibleForMilliseconds(e){const t=this.elt.style.opacity;"0"!==t&&(this.elt.style.opacity="0",setTimeout((()=>this.elt.style.opacity=t),e))}setHeight(e){this.elt.style.height=e.toString()}setPosition(e,t){this.elt.style.left=`${e}px`,this.elt.style.top=`${t}px`}render(){}afterRender(){}fullRender(){return this.valid?(l.pushRenderView(this),this.childSpecs=[],this.render(),this.checkChildren(),this.applyStyle(),this.applyDecorationAndWrapperStyles(),l.popRenderView(),this.afterRender(),this):this}addDecoration(e,t,i="div"){return this.decorationSpecs.push({name:e,tagName:i,cssClass:t}),this}appendDecoration(e){return this.elt.appendChild(e.elt),e.parent=this,this}decorationNamed(e){return this.decorations.find((t=>t.name===e))}createDecoration(e){const t={style:e.cssClass},i=new l(e.name,t,e.tagName);return i.isDecoration=!0,this.decorations.push(i),i}checkDecoration(e){this.decorationNamed(e.name)||this.appendDecoration(this.createDecoration(e))}includesViewNamed(e){return this.wrappedViewNames.some((t=>e.match(t)))}addWrapping(e,t,...i){return this.wrappingSpecs.push({name:e,cssClass:t,viewNames:i}),this}addModalWrapping(e,t,i,...s){this.addWrapping(e,(()=>i.get()?t:"hidden"),...s)}appendWrapping(e){return this.elt.appendChild(e.elt),e.parent=this,this}wrappingForChild(e){return this.wrappings.find((t=>t.includesViewNamed(e)))}wrappingNamed(e){return this.wrappings.find((t=>t.name===e))}createWrapping(e){const t={style:e.cssClass},i=new l(e.name,t,"div");return i.isDecoration=!0,i.isWrapping=!0,i.wrappedViewNames=e.viewNames,this.wrappings.push(i),i}checkWrapping(e){this.wrappingNamed(e.name)||this.appendWrapping(this.createWrapping(e))}createChild(e){const t=e.viewClass;e.params.style||(e.params.style=t.defaultStyle);const i=new t(e.name,e.params,t.defaultTagName||"div");return i.fullRender(),i}checkChild(e){if(!this.childNamed(e.name)){const t=this.wrappingForChild(e.name),i=this.createChild(e);t?t.appendChild(i):this.appendChild(i)}}checkChildren(){this.wrappingSpecs.forEach((e=>this.checkWrapping(e))),this.decorationSpecs.forEach((e=>this.checkDecoration(e)));const e=this.childSpecs.map((e=>e.name));this.children.slice().forEach((t=>{e.includes(t.name)||this.removeChild(t)})),this.childSpecs.forEach((e=>{this.checkChild(e)})),this.fixChildren()}addChild({name:e,viewClass:t,params:i}){return this.childSpecs.push({name:e,viewClass:t,params:i}),this}getChildren(e,t){if(!e.children)return[];let i=[];return Array.from(e.children).forEach((e=>{const s=e["data-zaffre"];s&&t.includes(s.name)?i.push(e["data-zaffre"]):i=[...i,...this.getChildren(e,t)]})),i}fixChildren(){this.children=this.getChildren(this.elt,this.childSpecs.map((e=>e.name)))}addClass(e){return this.elt.classList.add(e),this}addEventListener(e,t){return t&&this.elt.addEventListener(e,t),this}addOrRemoveEventListener(e,t,i){return t&&(i?this.elt.addEventListener(e,t):this.elt.removeEventListener(e,t)),this}addOrRemoveClass(e,t){return t?this.addClass(e):this.removeClass(e),this}appendChild(e){return e.elt&&this.elt.appendChild(e.elt),this.isWrapping?(e.parent=this.parent,this.parent?.children.push(e)):(e.parent=this,this.children.push(e)),this}classList(){return this.elt.classList}clear(){return this.elt.innerHTML="",this.children=[],this}clientRect(){return this.elt.getBoundingClientRect()}containsClass(e){return this.elt.classList.contains(e)}eventTargetIsSelf(e){return e.target===this.elt}focus(){return setTimeout((()=>this.elt.focus()),200),this}hasNextSibling(){return this.elt.nextElementSibling}hasParent(){return this.elt.parentElement}hasPreviousSibling(){return this.elt.previousElementSibling}innerHTML(){return this.elt.innerText}innerText(){return this.elt.innerText}isContentEditable(){return"true"==this.elt.contentEditable}moveAfter(e){e&&(this.elt.parentNode?.insertBefore(this.elt,e.elt.nextElementSibling),this.parent?.fixChildren())}moveBefore(e){e&&(this.elt.parentNode?.insertBefore(this.elt,e.elt),this.parent?.fixChildren())}moveAfterNextSibling(){this.elt.nextElementSibling&&(this.elt.parentNode?.insertBefore(this.elt.nextElementSibling,this.elt),this.parent?.fixChildren())}moveBeforePreviousSibling(){this.elt.previousElementSibling&&(this.elt.parentNode?.insertBefore(this.elt,this.elt.previousElementSibling),this.parent?.fixChildren())}nextSibling(){return this.elt.nextElementSibling}nextSiblingView(){return this.nextSibling()?this.nextSibling()["data-zaffre"]:null}previousSibling(){return this.elt.previousElementSibling}previousSiblingView(){return this.previousSibling()?this.previousSibling()["data-zaffre"]:null}removeAttribute(e){this.elt.removeAttribute(e)}removeChild(e){e.elt?.remove(),e.parent=null,e.release(),this.fixChildren()}removeClass(e){return this.elt.classList.remove(e),this}removeEventListener(e,t){return this.elt.removeEventListener(e,t),this}replaceClass(e,t){return this.elt.classList.replace(e,t),this}scrollIntoViewIfNeeded(){if(!this.elt.parentElement)return this;const e=this.clientRect(),t=this.elt.parentElement.getBoundingClientRect().height-25;e.bottom>t&&this.elt.parentElement.scrollBy(0,e.bottom-t+8);const i=this.clientRect();return i.top<0&&this.elt.parentElement.scrollBy(0,i.top-2),this}setAttribute(e,t){return this.elt.setAttribute(e,t),this}setBorderStyle(e){this.elt.style.borderStyle=e}setCSSClass(e){return this.elt.className=e,this}setContentEditable(e){this.elt.contentEditable=e.toString()}setInnerHTML(e){return this.elt.innerHTML=e,this}setInnerText(e){return this.elt.innerText=e,this}setTabIndex(e){this.setAttribute("tabindex",e.toString())}setTextContent(e){return this.elt.textContent=e,this}setTitle(e){return this.elt.title=e,this}toggleClass(e){return this.elt.classList.toggle(e),this}toString(){return this.constructor.name}lengthOfNode(e){const t=e.nodeName.toLowerCase();return"br"===t?1:"#text"===t?e.length:0}getNodeAtPosition(e){const t=document.createNodeIterator(this.elt,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);let i,s=0,o=null;for(;i=t.nextNode();){const t=this.lengthOfNode(i);if(s+t>e)return i;s+=t,o=i}return o}getPositionOfNode(e){const t=document.createNodeIterator(this.elt,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);let i,s=0;for(;i=t.nextNode();){if(i===e)return s;s+=this.lengthOfNode(i)}return s}convertRangeToInterval(e){this.elt.normalize();const t=e.startContainer===this.elt?this.elt.childNodes[e.startOffset]:e.startContainer,i=e.endContainer===this.elt?this.elt.childNodes[e.endOffset]:e.endContainer;let s=this.getPositionOfNode(t),o=this.getPositionOfNode(i);return e.startContainer!==this.elt&&(s+=e.startOffset,o+=e.endOffset),n.default.create(s,o)}convertIntervalToRange(e){if(e.isNull())return null;this.elt.normalize();const t=document.createRange(),i=this.getNodeAtPosition(e.start);if(!i)return null;const s=this.getPositionOfNode(i);if(e.start===e.end&&s===e.start&&i!==this.elt){const e=Array.prototype.indexOf.call(this.elt.childNodes,i);t.setStart(this.elt,e),t.setEnd(this.elt,e)}else{const o=this.getNodeAtPosition(e.end);if(!o)return null;const r=this.getPositionOfNode(o);t.setStart(i,e.start-s),t.setEnd(o,e.end-r)}return t}setSelectionInterval(e){if(e){const t=window.getSelection(),i=this.convertIntervalToRange(e);t&&i&&(t.removeAllRanges(),t.addRange(i))}}getSelectionInterval(){const e=window.getSelection();return e&&0!==e.rangeCount?this.convertRangeToInterval(e.getRangeAt(0)):n.default.nullInterval}deleteTextInInterval(e){const t=e.boundedBy(0,this.innerText().length),i=this.convertIntervalToRange(t);i&&(t.end!==t.start+1||"BR"!==i.startContainer.nodeName?t.end!==t.start+1||"BR"!==i.endContainer.nodeName?i.deleteContents():i.endContainer.remove():i.startContainer.remove())}insertText(e,t){const i=Math.max(0,Math.min(t,this.innerText().length));if(!this.getNodeAtPosition(i))return void console.log("insertText: null node");const s=this.convertIntervalToRange(n.default.create(i,i));if(s){const i=document.createTextNode(e);s.insertNode(i),s.selectNodeContents(i),s.collapse(!1);const o=t+e.length;this.setSelectionInterval(n.default.create(o,o))}}}t.ZView=l,l.renderStack=[],l.useScheduler=!1,l.viewsToRender=[],t.default=l},813:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=i(904);class o{static valueof(e){return o.isProp(e)?e.get():o.isFunction(e)?e():e}static isFunction(e){return"function"==typeof e}static functionName(e){return o.isFunction(e)?o.last(e.name.split(" ")):null}static isArray(e){return Array.isArray(e)}static isObject(e){return e&&!o.isArray(e)&&"object"==typeof e}static isString(e){return"string"==typeof e}static isRegExp(e){return e instanceof RegExp}static isProp(e){return e instanceof s.default}static mapObjectValues(e,t){return o.isEmptyObject(e)?{}:Object.fromEntries(Object.entries(e).map((([e,i])=>[e,t(i)])))}static isEmptyObject(e){return e&&0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}static clone(e){return e?Object.assign(Object.create(Object.getPrototypeOf(e)),e):null}static selectKeys(e,t){const i={};for(const s of t)s in e&&(i[s]=e[s])}static indexes(e,t){return Array(t-e+1).fill(null).map(((t,i)=>e+i))}static deleteAtIndex(e,t){return o.splice(e,t,1)}static deleteValue(e,t){return o.splice(e,e.indexOf(t),1)}static duplicate(e){return e.slice()}static insertAtIndex(e,t,...i){return o.splice(e,t,0,...i)}static splice(e,t,i,...s){const r=o.duplicate(e);return r.splice(t,i,...s),r}static firstOrNull(e){return e&&0!==e.length?e[0]:null}static last(e){return e&&0!==e.length?e[e.length-1]:null}static moveElementDown(e,t){return t<0||t>=e.length-1?e:[...e.slice(0,t),e[t+1],e[t],...e.slice(t+2)]}static moveElementUp(e,t){return 0===t||t>=e.length?e:[...e.slice(0,t-1),e[t],e[t-1],...e.slice(t+1)]}static count(e,t){return e.filter(t).length}static sum(e,t){return e.reduce(((e,i)=>e+t(i)),0)}static allButFirst(e,t=1){return e.slice(t)}static allButLast(e,t=1){return e.slice(0,e.length-t)}static allButFirstAndLast(e){return e.slice(1,e.length-1)}static isNonEmptyArray(e){return o.isArray(e)&&e.length>0}static firstLine(e){return e.split("\n",1)[0]}static sameAs(e,t){return e.toLowerCase()===t.toLowerCase()}static capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}static kebabize(e){return e.split("").map(((e,t)=>e.toUpperCase()===e?`${0!==t?"-":""}${e.toLowerCase()}`:e)).join("")}static insertElementAfter(e,t){t.parentNode?.insertBefore(e,t?.nextSibling)}static indexOfChildElement(e){return e?Array.prototype.indexOf.call(e.parentElement,e):-1}static scrollElementIntoViewIfNeeded(e,t=!0){const i=e.parentElement;if(!i)return;const s=window.getComputedStyle(i,null),o=parseInt(s.getPropertyValue("border-top-width")),r=parseInt(s.getPropertyValue("border-left-width")),n=e.offsetTop-i.offsetTop<i.scrollTop,a=e.offsetTop-i.offsetTop+e.clientHeight-o>i.scrollTop+i.clientHeight,l=e.offsetLeft-i.offsetLeft<i.scrollLeft,c=e.offsetLeft-i.offsetLeft+e.clientWidth-r>i.scrollLeft+i.clientWidth,d=n&&!a;(n||a)&&t&&(i.scrollTop=e.offsetTop-i.offsetTop-i.clientHeight/2-o+e.clientHeight/2),(l||c)&&t&&(i.scrollLeft=e.offsetLeft-i.offsetLeft-i.clientWidth/2-r+e.clientWidth/2),(n||a||l||c)&&!t&&e.scrollIntoView(d)}}t.default=o}},t={};function i(s){var o=t[s];if(void 0!==o)return o.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,i),r.exports}var s={};(()=>{var e=s;Object.defineProperty(e,"__esModule",{value:!0}),e.showLink=void 0;const t=i(928),o=i(732),r=i(602),n=i(866),a=i(935);try{o.default.vscode=acquireVsCodeApi()}catch{o.default.vscode=null}n.default.initialize(),o.default.vscode?t.default.createRootView(r.default):async function(e){const t=await fetch("./recaps.json");if(!t.ok)return;const i=await t.json();a.default.openOn(e,i.recaps)}(new URL(document.location.toString()).searchParams.get("recap")||""),e.showLink=function(e){o.default.showMarkdownLink(e)}})(),Recap=s})();